import os, sys, pathlib

def list_csv_sorted(root: str):
    p = pathlib.Path(root)
    files = [f for f in p.glob('*.csv')]
    if "{{ constraints.sort_by }}" == 'size' and "{{ constraints.order }}" == 'desc':
        files.sort(key=lambda f: f.stat().st_size, reverse=True)
    else:
        files.sort(key=lambda f: f.name)
    return [f"{f.name},{f.stat().st_size}" for f in files]

if __name__ == '__main__':
    root = sys.argv[1] if len(sys.argv)>1 else 'tasks/sample_csv/input'
    for line in list_csv_sorted(root):
        print(line)
